{"version":3,"sources":["webpack:///../node_modules/events/events.js","webpack:///../@here/harp-utils/lib/GroupedPriorityList.ts","webpack:///../@here/harp-utils/lib/Logger/ConsoleChannel.ts","webpack:///../@here/harp-utils/lib/Logger/ILogger.ts","webpack:///../@here/harp-utils/lib/Logger/Logger.ts","webpack:///../@here/harp-utils/lib/Logger/WorkerChannel.ts","webpack:///../@here/harp-utils/lib/Logger/LoggerManagerImpl.ts","webpack:///../@here/harp-utils/lib/Logger/LoggerManager.ts","webpack:///../@here/harp-utils/lib/Math2D.ts","webpack:///../@here/harp-utils/lib/MathUtils.ts","webpack:///../@here/harp-utils/lib/Mixins.ts","webpack:///../@here/harp-utils/lib/assert.ts","webpack:///../@here/harp-utils/lib/ContextLogger.ts","webpack:///../@here/harp-utils/lib/PerformanceTimer.ts","webpack:///../@here/harp-utils/lib/ObjectUtils.ts","webpack:///../@here/harp-utils/lib/OptionsUtils.ts","webpack:///../@here/harp-utils/lib/UrlUtils.ts","webpack:///../@here/harp-utils/lib/UriResolver.ts","webpack:///../@here/harp-utils/lib/UrlPlatformUtils.web.ts","webpack:///../@here/harp-utils/lib/Functions.ts","webpack:///../@here/harp-utils/index.ts","webpack:///./WorkerMapViewService.ts"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","module","exports","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","$getMaxListeners","that","_addListener","type","listener","prepend","m","events","existing","warning","TypeError","create","newListener","emit","unshift","push","length","warned","w","Error","String","name","emitter","count","console","warn","onceWrapper","i","arguments","fired","removeListener","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","n","copy","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","len","listeners","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","PriorityListGroup","priority","elements","slice","GroupedPriorityList","groups","Map","element","getGroup","group","foundIndex","indexOf","splice","normalizedPriority","Math","floor","delete","m_sortedGroups","clear","other","otherGroup","findGroup","clone","priorityList","sort","a","b","fun","forEach","ConsoleChannel","optionalParams","debug","info","log","trace","LogLevel","m_channel","options","enabled","level","Trace","update","prefix","Debug","Info","Log","Warn","WORKERCHANNEL_MSG_TYPE","workerMessage","self","postMessage","m_loggers","channel","document","map","logger","find","loggerName","m_levelSetForAll","found","config","m_instance","Math2D","MathUtils","applyMixinsWithoutProperties","derivedCtor","baseCtors","baseCtor","descriptor","getOwnPropertyDescriptor","distSquared","ax","ay","bx","by","Box","x","y","h","computeSquaredLineLength","line","squaredLineLength","xDiff","yDiff","distToSegmentSquared","px","py","l0x","l0y","l1x","l1y","lineLengthSuared","t","max","min","clamp","lerp","edge0","edge1","factor","smoothStep","smootherStep","val","inMin","inMax","outMin","outMax","min2","result","max2","isClamped","lowerBound","upperBound","easeInOutCubic","startValue","endValue","time","isProduction","assert","condition","assertExists","ContextLogger","m_logger","headerMessage","m_headerLogged","createLogMethod","severity","rest","join","PerformanceTimer","nowFunc","performance","now","Date","getTime","cloneDeep","obj","cache","r","cloneInternal","src","cached","isArray","RegExp","source","flags","constructor","hasOwnProperty","getOptionValue","values","candidate","resolveReferenceUri","parentUri","childUri","absoluteUrlWithOriginRe","test","startsWith","getUrlOrigin","substr","baseUrl","instance","getNowFunc","url","idx","lastIndexOf","substring","parsed","urlOriginRe","match","protocol","host","getUrlHostAndProtocol","uri","composeUriResolvers","resolvers","resolveUri","originalUrl","reduce","resolver","getAppBaseUrl","window","appBaseUrl","location","href","setAppBaseUrl","v","chainCallbacks","f1","f2","eventHandler","addEventListener","event","data","canvas","style","width","clientWidth","height","clientHeight","pixelRatio","resize","lookAt","lat","long","distance","tiltDeg","headingDeg","beginAnimation","ev","eventName"],"mappings":"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","file":"5-chunk.bundle.js","sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A `PriorityListElement` has a priority to assist in sorting. The idea is that the items in a\n * grouped priority list will not modify their priority during processing to such an amount, that\n * they will change into another group. Smaller lists are smaller to sort, and in case of resource\n * limitation (maximum number of rendered objects reached), not all items have to be sorted at all.\n */\nexport interface PriorityListElement {\n    /**\n     * The integer value of this priority is used to group objects of \"same\" priority.\n     */\n    priority: number;\n}\n\n/**\n * The `PriorityListGroup` contains a list of [[PriorityListElement]]s that all have the same\n * (integer) priority.\n */\nexport class PriorityListGroup<T extends PriorityListElement> {\n    constructor(readonly priority: number, public elements: T[] = new Array()) {}\n\n    /**\n     * Create and return a deep copy of the `PriorityListGroup<T>`.\n     *\n     * @returns A clone of the `PriorityListGroup<T>`.\n     */\n    clone(): PriorityListGroup<T> {\n        return new PriorityListGroup<T>(this.priority, this.elements.slice());\n    }\n}\n\n/**\n * The `PriorityListGroupMap` is a map to map the (integer) priority to a [[PriorityListGroup]].\n */\nexport type PriorityListGroupMap<T extends PriorityListElement> = Map<number, PriorityListGroup<T>>;\n\n/**\n * The `GroupedPriorityList` contains a [[PriorityListGroupMap]] to manage a larger number of items\n * in priority groups.\n */\nexport class GroupedPriorityList<T extends PriorityListElement> {\n    readonly groups: PriorityListGroupMap<T> = new Map();\n    private m_sortedGroups: Array<PriorityListGroup<T>> | undefined;\n    /**\n     * Add an element to the `GroupedPriorityList`. Selects group based on the elements priority.\n     *\n     * @param element Element to be added.\n     */\n    add(element: T): void {\n        this.getGroup(element.priority).elements.push(element);\n    }\n\n    /**\n     * Remove an element from the `GroupedPriorityList`.\n     *\n     * Note: It is required that the priority is the same as it was when the element has been added.\n     * Otherwise, the removal will fail.\n     *\n     * @param element Element to be removed.\n     * @returns `True` if the element was removed, `false` otherwise.\n     */\n    remove(element: T): boolean {\n        const group = this.getGroup(element.priority);\n        if (group !== undefined) {\n            const foundIndex = group.elements.indexOf(element);\n            if (foundIndex >= 0) {\n                group.elements.splice(foundIndex, 1);\n                if (group.elements.length === 0) {\n                    const normalizedPriority = Math.floor(element.priority);\n                    this.groups.delete(normalizedPriority);\n                    if (this.m_sortedGroups) {\n                        this.m_sortedGroups = [];\n                    }\n                }\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * Remove all internal [[PriorityListGroup]]s.\n     */\n    clear(): void {\n        this.groups.clear();\n        if (this.m_sortedGroups) {\n            this.m_sortedGroups = [];\n        }\n    }\n\n    /**\n     * Merge another [[GroupedPriorityList]] into this one.\n     *\n     * @param other Other group to merge.\n     */\n    merge(other: GroupedPriorityList<T>): GroupedPriorityList<T> {\n        for (const otherGroup of other.groups) {\n            const group = this.findGroup(otherGroup[1].priority);\n            if (group === undefined) {\n                this.groups.set(Math.floor(otherGroup[1].priority), otherGroup[1].clone());\n                if (this.m_sortedGroups) {\n                    this.m_sortedGroups = [];\n                }\n                continue;\n            }\n            group.elements = group.elements.concat(otherGroup[1].elements);\n        }\n        return this;\n    }\n\n    /**\n     * Return a sorted list of [[PriorityListGroup]]s.\n     */\n    get sortedGroups(): Array<PriorityListGroup<T>> {\n        if (this.m_sortedGroups && this.m_sortedGroups.length > 0) {\n            return this.m_sortedGroups;\n        }\n\n        if (!this.m_sortedGroups) {\n            this.m_sortedGroups = [];\n        }\n        for (const priorityList of this.groups) {\n            this.m_sortedGroups.push(priorityList[1]);\n        }\n\n        this.m_sortedGroups.sort((a: PriorityListGroup<T>, b: PriorityListGroup<T>) => {\n            return b.priority - a.priority;\n        });\n        return this.m_sortedGroups;\n    }\n\n    /**\n     * Apply function to all elements in this `GroupedPriorityList`.\n     *\n     * @param {(element: T) => void} fun Function to apply.\n     */\n    forEach(fun: (element: T) => void): void {\n        for (const group of this.groups) {\n            group[1].elements.forEach(fun);\n        }\n    }\n\n    /**\n     * Count the number of elements in this `GroupedPriorityList`.\n     */\n    count(): number {\n        let n = 0;\n        for (const group of this.groups) {\n            n += group[1].elements.length;\n        }\n        return n;\n    }\n\n    /**\n     * Get group of elements that have the same (integer) priority.\n     *\n     * @param priority The priority to retrieve all elements from.\n     */\n    private findGroup(priority: number): PriorityListGroup<T> | undefined {\n        const normalizedPriority = Math.floor(priority);\n        const group = this.groups.get(normalizedPriority);\n        return group;\n    }\n\n    /**\n     * Get group of elements that have the same (integer) priority.\n     *\n     * @param priority The priority to retrieve all elements from.\n     */\n    private getGroup(priority: number): PriorityListGroup<T> {\n        let group = this.findGroup(priority);\n\n        if (group === undefined) {\n            const normalizedPriority = Math.floor(priority);\n            group = new PriorityListGroup<T>(normalizedPriority);\n            this.groups.set(normalizedPriority, group);\n            if (this.m_sortedGroups) {\n                this.m_sortedGroups = [];\n            }\n        }\n\n        return group;\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IChannel } from \"./IChannel\";\n\n/**\n * Class for the default console channel.\n */\n\nexport class ConsoleChannel implements IChannel {\n    error(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.error(message, ...optionalParams);\n    }\n\n    debug(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.debug(message, ...optionalParams);\n    }\n\n    info(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.info(message, ...optionalParams);\n    }\n\n    log(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.log(message, ...optionalParams);\n    }\n\n    trace(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.trace(message, ...optionalParams);\n    }\n\n    warn(message?: any, ...optionalParams: any[]) {\n        // tslint:disable-next-line:no-console\n        console.warn(message, ...optionalParams);\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IChannel } from \"./IChannel\";\n\n/**\n * Enum log levels\n */\nexport enum LogLevel {\n    Trace,\n    Debug,\n    Log,\n    Info,\n    Warn,\n    Error\n}\n\n/**\n * Logger options to configure logger\n */\nexport class LoggerOptions {\n    enabled?: boolean;\n    level?: LogLevel;\n}\n\n/**\n * Public interface for Logger class.\n */\nexport interface ILogger extends IChannel {\n    readonly name: string;\n\n    enabled: boolean;\n\n    level: LogLevel;\n\n    /**\n     * Update logger options\n     *\n     * @param  {LoggerOptions} options Set logger options and configure internal logger.\n     */\n    update(options: LoggerOptions): void;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IChannel } from \"./IChannel\";\nimport { ILogger, LoggerOptions, LogLevel } from \"./ILogger\";\n\n/**\n * Logger class.\n */\nexport class Logger implements ILogger {\n    enabled: boolean = true;\n    level: LogLevel = LogLevel.Trace;\n\n    constructor(readonly name: string, private m_channel: IChannel, options?: LoggerOptions) {\n        if (options !== undefined) {\n            this.update(options);\n        }\n    }\n\n    error(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Error) {\n            this.m_channel.error(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    debug(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Debug) {\n            this.m_channel.debug(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    info(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Info) {\n            this.m_channel.info(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    log(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Log) {\n            this.m_channel.log(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    trace(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Trace) {\n            this.m_channel.trace(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    warn(message?: any, ...optionalParams: any[]) {\n        if (this.enabled && this.level <= LogLevel.Warn) {\n            this.m_channel.warn(this.prefix, message, ...optionalParams);\n        }\n    }\n\n    update(options: LoggerOptions) {\n        this.enabled = options.enabled === undefined ? this.enabled : options.enabled;\n        this.level = options.level === undefined ? this.level : options.level;\n    }\n\n    private get prefix(): string {\n        return this.name + \":\";\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IChannel } from \"./IChannel\";\nimport { LogLevel } from \"./ILogger\";\n\ndeclare let self: Worker;\n\nexport const WORKERCHANNEL_MSG_TYPE = \"worker-channel-message\";\n\n/**\n * The interface for the messages of the WorkerChannel.\n */\nexport interface IWorkerChannelMessage {\n    message: any[];\n    type: \"worker-channel-message\";\n    level: LogLevel;\n}\n\n/**\n * The class for the worker channel.\n */\nexport class WorkerChannel implements IChannel {\n    error(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Error\n        };\n        self.postMessage(workerMessage);\n    }\n\n    debug(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Debug\n        };\n        self.postMessage(workerMessage);\n    }\n\n    info(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Info\n        };\n        self.postMessage(workerMessage);\n    }\n\n    log(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Log\n        };\n        self.postMessage(workerMessage);\n    }\n\n    trace(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Trace\n        };\n        self.postMessage(workerMessage);\n    }\n\n    warn(message?: any, ...optionalParams: any[]) {\n        const workerMessage: IWorkerChannelMessage = {\n            message: [message, ...optionalParams],\n            type: WORKERCHANNEL_MSG_TYPE,\n            level: LogLevel.Warn\n        };\n        self.postMessage(workerMessage);\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ConsoleChannel } from \"./ConsoleChannel\";\nimport { IChannel } from \"./IChannel\";\nimport { ILogger, LoggerOptions, LogLevel } from \"./ILogger\";\nimport { ILoggerManager } from \"./ILoggerManager\";\nimport { Logger } from \"./Logger\";\nimport { WorkerChannel } from \"./WorkerChannel\";\n\n/**\n * LoggerManagerImpl is the class for the singleton instance of the logger manager.\n * It handles channels and loggers.\n */\n\nexport class LoggerManagerImpl implements ILoggerManager {\n    channel: IChannel;\n    private readonly m_loggers: ILogger[] = [];\n    private m_levelSetForAll?: LogLevel;\n\n    constructor() {\n        this.channel =\n            typeof self === \"undefined\" || typeof self.document !== \"undefined\"\n                ? new ConsoleChannel()\n                : new WorkerChannel();\n    }\n\n    getLoggerNames(): string[] {\n        return this.m_loggers.map(logger => logger.name);\n    }\n\n    getLogger(name: string): ILogger | undefined {\n        return this.m_loggers.find(logger => logger.name === name);\n    }\n\n    create(loggerName: string, options: LoggerOptions = {}): ILogger {\n        if (\n            this.m_levelSetForAll !== undefined &&\n            (options.level === undefined || options.level < this.m_levelSetForAll)\n        ) {\n            options.level = this.m_levelSetForAll;\n        }\n        const logger = new Logger(loggerName, this.channel, options);\n        this.m_loggers.push(logger);\n        return logger;\n    }\n\n    dispose(logger: ILogger) {\n        const found = this.m_loggers.indexOf(logger);\n        if (found < 0) {\n            throw new Error(`Cannot unregister \"${logger}\" : no such logger registered.`);\n        }\n        this.m_loggers.splice(found, 1);\n    }\n\n    updateAll(options: LoggerOptions) {\n        for (const logger of this.m_loggers) {\n            logger.update(options);\n        }\n    }\n\n    update(loggerName: string, config: LoggerOptions) {\n        for (const logger of this.m_loggers) {\n            if (logger.name === loggerName) {\n                logger.update(config);\n            }\n        }\n    }\n\n    enableAll(enabled: boolean) {\n        for (const logger of this.m_loggers) {\n            logger.enabled = enabled;\n        }\n    }\n\n    enable(loggerName: string, value: boolean) {\n        this.update(loggerName, { enabled: value });\n    }\n\n    setLogLevelForAll(level: LogLevel) {\n        this.m_levelSetForAll = level;\n        for (const logger of this.m_loggers) {\n            logger.level = level;\n        }\n    }\n\n    setLogLevel(loggerName: string, level: LogLevel) {\n        this.update(loggerName, { level });\n    }\n\n    setChannel(channel: IChannel) {\n        this.channel = channel;\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ILoggerManager } from \"./ILoggerManager\";\nimport { LoggerManagerImpl } from \"./LoggerManagerImpl\";\n\n/**\n * The LoggerManager class implements a singleton object that handles logging.\n *\n * Example:\n *\n * ```typescript\n *\n * const logger = LoggerManager.instance.create(\"MyFontLoaderClass\");\n * if (missingFonts.length > 0) {\n *     logger.error(\"These fonts can not be loaded: \", missingFonts);\n * } else {\n *     logger.log(\"All fonts have been loaded.\");\n * }\n * ```\n */\nexport class LoggerManager {\n    private static m_instance: ILoggerManager;\n\n    static get instance(): ILoggerManager {\n        return this.m_instance || (this.m_instance = new LoggerManagerImpl());\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport namespace Math2D {\n    /**\n     * Alternative 2D box object with less memory impact (four numbers instead of two min/max\n     * objects with two numbers each). Should be faster.\n     */\n    export class Box {\n        /**\n         * Alternative 2D box object with less memory impact (four numbers instead of two min/max\n         * objects with two numbers each). Should be faster.\n         *\n         * @param x New X value.\n         * @param y New y value.\n         * @param w New w value.\n         * @param h New h value.\n         */\n        constructor(public x = 0, public y = 0, public w = 0, public h = 0) {}\n\n        /**\n         * Set new values to all properties of the box.\n         *\n         * @param x New X value.\n         * @param y New y value.\n         * @param w New w value.\n         * @param h New h value.\n         */\n        set(x: number, y: number, w: number, h: number) {\n            this.x = x;\n            this.y = y;\n            this.w = w;\n            this.h = h;\n        }\n\n        /**\n         * Test box for inclusion of point.\n         *\n         * @param x X coordinate of point.\n         * @param y Y coordinate of point.\n         */\n        contains(x: number, y: number): boolean {\n            return this.x <= x && this.x + this.w >= x && this.y <= y && this.y + this.h >= y;\n        }\n\n        /**\n         * Test two boxes for intersection.\n         *\n         * @param other Box 2 to test for intersection.\n         */\n        intersects(other: Box): boolean {\n            return (\n                this.x <= other.x + other.w &&\n                this.x + this.w >= other.x &&\n                this.y <= other.y + other.h &&\n                this.y + this.h >= other.y\n            );\n        }\n    }\n\n    /**\n     * Box to store UV coordinates.\n     */\n    export interface UvBox {\n        s0: number;\n        t0: number;\n        s1: number;\n        t1: number;\n    }\n\n    /**\n     * Compute squared distance between two 2D points `a` and `b`.\n     *\n     * @param ax Point a.x\n     * @param ay Point a.y\n     * @param bx Point b.x\n     * @param by Point b.y\n     * @returns Squared distance between the two points\n     */\n    export function distSquared(ax: number, ay: number, bx: number, by: number): number {\n        return (ax - bx) * (ax - bx) + (ay - by) * (ay - by);\n    }\n\n    /**\n     * Computes the squared length of a line.\n     *\n     * @param line An array of that forms a line via [x,y,z,x,y,z,...] tuples.\n     */\n    export function computeSquaredLineLength(line: number[]): number {\n        let squaredLineLength: number = 0;\n\n        const length = line.length - 4;\n        for (let i = 0; i < length; i += 3) {\n            const xDiff = line[i + 3] - line[i];\n            const yDiff = line[i + 4] - line[i + 1];\n            squaredLineLength += xDiff * xDiff + yDiff * yDiff;\n        }\n        return squaredLineLength;\n    }\n\n    /**\n     * Compute squared distance between a 2D point and a 2D line segment.\n     *\n     * @param px Test point X\n     * @param py Test point y\n     * @param l0x Line segment start X\n     * @param l0y Line segment start Y\n     * @param l1x Line segment end X\n     * @param l1y Line segment end Y\n     * @returns Squared distance between point and line segment\n     */\n    export function distToSegmentSquared(\n        px: number,\n        py: number,\n        l0x: number,\n        l0y: number,\n        l1x: number,\n        l1y: number\n    ): number {\n        const lineLengthSuared = distSquared(l0x, l0y, l1x, l1y);\n        if (lineLengthSuared === 0) {\n            return distSquared(px, py, l0x, l0y);\n        }\n        let t = ((px - l0x) * (l1x - l0x) + (py - l0y) * (l1y - l0y)) / lineLengthSuared;\n        t = Math.max(0, Math.min(1, t));\n        return distSquared(px, py, l0x + t * (l1x - l0x), l0y + t * (l1y - l0y));\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport namespace MathUtils {\n    /**\n     * Ensures that input value fits in a given range.\n     *\n     * @param value The value to be clamped.\n     * @param min Minimum value.\n     * @param max Maximum value.\n     *\n     * @returns Clamped value.\n     */\n    export function clamp(value: number, min: number, max: number): number {\n        return value < min ? min : value > max ? max : value;\n    }\n\n    /**\n     * Returns a linear interpolation between the values of edge0 and edge1 based on the factor.\n     *\n     * Given two known points the linear interpolant between these points may be presented as\n     * straight line. This means that for given factor change the resulting change of return\n     * value is always const.\n     * @see https://en.wikipedia.org/wiki/Linear_interpolation\n     *\n     * @param edge0\n     * @param edge1\n     * @param factor Interpolation factor that ranges between: 0 <= x <= 1.\n     */\n    export function lerp(edge0: number, edge1: number, factor: number): number {\n        return edge0 * (1 - factor) + edge1 * factor;\n    }\n\n    /**\n     * Returns a smooth interpolation between the values edge0 and edge1 based on the interpolation\n     * factor x. `0 <= x <= 1`.\n     * @see https://en.wikipedia.org/wiki/Smoothstep\n     *\n     * @param edge0\n     * @param edge1\n     * @param x\n     */\n    export function smoothStep(edge0: number, edge1: number, x: number) {\n        // Scale, bias and saturate x to 0..1 range\n        x = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n        // Evaluate polynomial\n        return x * x * (3 - 2 * x);\n    }\n\n    /**\n     * Returns a smooth interpolation between the values edge0 and edge1 based on the interpolation\n     * factor x. `0 <= x <= 1`.\n     *\n     * Improved version by Ken Perlin, which has zero 1st- and 2nd-order derivatives at `x = 0` and\n     * `x = 1`:\n     *\n     * @see https://en.wikipedia.org/wiki/Smoothstep\n     *\n     * @param edge0\n     * @param edge1\n     * @param x\n     */\n    export function smootherStep(edge0: number, edge1: number, x: number) {\n        // Scale, and clamp x to 0..1 range\n        x = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n        // Evaluate polynomial\n        return x * x * x * (x * (x * 6 - 15) + 10);\n    }\n\n    /**\n     * Maps a number from one range to another.\n     *\n     * @param val The incoming value to be converted.\n     * @param inMin Lower bound of the value's current range.\n     * @param inMax Upper bound of the value's current range.\n     * @param outMin Lower bound of the value's target range.\n     * @param outMax Upper bound of the value's target range.\n     */\n    export function map(val: number, inMin: number, inMax: number, outMin: number, outMax: number) {\n        return ((val - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\n    }\n\n    /**\n     * Returns the smaller of the two given numbers. Both numbers may be undefined, in which case\n     * the result is undefined. If only one of the numbers is undefined, the other number is\n     * returned.\n     *\n     * @param a First number.\n     * @param b Second number.\n     */\n    export function min2(a: number | undefined, b: number | undefined): number | undefined {\n        let result: number | undefined;\n\n        if (a !== undefined) {\n            result = a;\n        }\n        if (b !== undefined) {\n            result = result === undefined ? b : Math.min(result, b);\n        }\n\n        return result;\n    }\n\n    /**\n     * Returns the larger of the two given numbers. Both numbers may be undefined, in which case\n     * the result is undefined. If only one of the numbers is undefined, the other number is\n     * returned.\n     *\n     * @param a First number.\n     * @param b Second number.\n     */\n    export function max2(a: number | undefined, b: number | undefined): number | undefined {\n        let result: number | undefined;\n\n        if (a !== undefined) {\n            result = a;\n        }\n        if (b !== undefined) {\n            result = result === undefined ? b : Math.max(result, b);\n        }\n\n        return result;\n    }\n\n    /**\n     * Checks if the value of a given number is inside an upper or lower bound. The bounds may be\n     * undefined, in which case their value is ignored.\n     *\n     * @param value Value to check.\n     * @param lowerBound The lower bound to check the value against.\n     * @param upperBound The upper bound to check the value against.\n     *\n     * @returns `true` if value is inside the bounds or if the bounds are `undefined`, `false`\n     *          otherwise.\n     */\n    export function isClamped(\n        value: number,\n        lowerBound: number | undefined,\n        upperBound: number | undefined\n    ): boolean {\n        if (lowerBound !== undefined && value < lowerBound) {\n            return false;\n        }\n        if (upperBound !== undefined && value > upperBound) {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * Smoothly interpolates between two values using cubic formula\n     *\n     * @param startValue\n     * @param endValue\n     * @param time\n     * @returns Result of the interpolation within the range of `[startValue, endValue]`\n     */\n    export function easeInOutCubic(startValue: number, endValue: number, time: number): number {\n        const timeValue =\n            time < 0.5 ? 4 * time * time * time : (time - 1) * (2 * time - 2) * (2 * time - 2) + 1;\n        return startValue + (endValue - startValue) * timeValue;\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Copy methods and properties from one prototype into another.\n *\n * @see https://www.typescriptlang.org/docs/handbook/mixins.html\n *\n * @param derivedCtor Class to mix methods and properties into.\n * @param baseCtors Class to take all methods and properties from.\n */\nexport function applyMixins(derivedCtor: any, baseCtors: any[]) {\n    baseCtors.forEach(baseCtor => {\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\n            derivedCtor.prototype[name] = baseCtor.prototype[name];\n        });\n    });\n}\n\n/**\n * Copy methods from one prototype into another.\n *\n * @see https://www.typescriptlang.org/docs/handbook/mixins.html\n *\n * @param derivedCtor Class to mix methods into.\n * @param baseCtors Class to take all methods from.\n */\nexport function applyMixinsWithoutProperties(derivedCtor: any, baseCtors: any[]) {\n    baseCtors.forEach(baseCtor => {\n        Object.getOwnPropertyNames(baseCtor.prototype).forEach(name => {\n            const descriptor = Object.getOwnPropertyDescriptor(baseCtor.prototype, name);\n            if (descriptor !== undefined && descriptor.get === undefined) {\n                derivedCtor.prototype[name] = baseCtor.prototype[name];\n            }\n        });\n    });\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\ndeclare const process: any;\n\n// cache value, because access to process.env.NODE_ENV is SLOW!\nconst isProduction = process.env.NODE_ENV === \"production\";\n\n//TODO: Make assertHandler configurable\n\n/**\n * Implementation of assert as a development help\n *\n * Note - this is deliberately a global function so that minimizers remove the\n * entire call when building for production.\n *\n * @hidden\n * @param condition Condition to match, if false, throws an Error(message)\n * @param message Optional message, defaults to \"ASSERTION failed\"\n */\nexport function assert(condition: boolean, message?: string): void {\n    if (!isProduction) {\n        if (!condition) {\n            throw new Error(message !== undefined ? message : \"ASSERTION failed\");\n        }\n    }\n}\n\nexport function assertExists<T>(element: T | undefined, message?: string): T {\n    if (!isProduction) {\n        if (element === undefined || element === null) {\n            throw new Error(\n                message !== undefined ? message : \"ASSERTION failed: Element is undefined or null\"\n            );\n        }\n    }\n    return element!;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Refinement of `console` interface only for important information i.e `info`, `warn` and `errors`.\n */\nexport interface ISimpleChannel {\n    info(message?: any, ...optionalParams: any[]): void;\n    warn(message?: any, ...optionalParams: any[]): void;\n    error(message?: any, ...optionalParams: any[]): void;\n}\n\n/**\n * Extension of [[ISimpleChannel]] to support contextual logging by adding stack of prefixes.\n */\nexport interface IContextLogger extends ISimpleChannel {\n    /**\n     * Push \"attribute-like\" context.\n     */\n    pushAttr(name: string): void;\n\n    /**\n     * Push \"index-like\" context.\n     *\n     * Following log messages will be prefixed with `[index]`.\n     */\n    pushIndex(index: string | number): void;\n\n    /**\n     * Remove current context from top of stack.\n     */\n    pop(): void;\n}\n\n/**\n * Context-aware logger that decorates log message with stack-based prefix, emits `headerMessage`\n * before first actual log message.\n */\nexport class ContextLogger implements IContextLogger {\n    private readonly context: string[] = [];\n    private m_headerLogged = false;\n\n    /**\n     * Construct a context-aware logger that logs to `m_logger`.\n     */\n    constructor(readonly m_logger: ISimpleChannel, readonly headerMessage: string) {}\n\n    /**\n     * Push \"attribute-like\" context.\n     *\n     * Following log messages will be prefixed with `name` or `.name` depending on current context.\n     */\n    pushAttr(name: string) {\n        this.context.push(`${this.context.length > 0 ? \".\" : \"\"}${name}`);\n    }\n\n    /**\n     * Push \"index-like\" context.\n     *\n     * Following log messages will be prefixed with `[index]`.\n     */\n    pushIndex(index: string | number) {\n        this.context.push(`[${index}]`);\n    }\n\n    pop() {\n        this.context.pop();\n    }\n\n    // They, are public member functions it's just tslint who doesn't understand this.\n\n    // tslint:disable:member-ordering\n    warn = this.createLogMethod(\"warn\");\n    info = this.createLogMethod(\"info\");\n    error = this.createLogMethod(\"error\");\n    // tslint:enable:member-ordering\n\n    private createLogMethod(severity: \"warn\" | \"info\" | \"error\") {\n        return (message: string, ...rest: any[]) => {\n            if (!this.m_headerLogged) {\n                this.m_logger.info(this.headerMessage);\n                this.m_headerLogged = true;\n            }\n            this.m_logger[severity](`${this.context.join(\"\")}: ${message}`, ...rest);\n        };\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/* tslint:disable:max-line-length */\n/**\n * See:\n * https://developers.google.com/web/updates/2012/08/When-milliseconds-are-not-enough-performance-now\n */\n/* tslint:ensable:max-line-length */\n\nexport class PerformanceTimer {\n    /**\n     * Returns timestamp in milliseconds since page load.\n     *\n     * If the [[DOMHighResTimeStamp]] is supported, the resolution is up to 5 microseconds,\n     * otherwise it is in milliseconds. Timespans are computed by taking the difference between two\n     * samples.\n     *\n     * Example:\n     * ```typescript\n     * const now = PerformanceTimer.now();\n     * // call some expensive function for which you want to check the duration.\n     * const end = PerformanceTimer.now();\n     * const elapsedTime = end - now;\n     * ```\n     */\n    static now(): number {\n        return PerformanceTimer.nowFunc();\n    }\n\n    // tslint:disable-next-line:no-unused-variable\n    private static readonly instance = new PerformanceTimer();\n\n    private static readonly nowFunc: () => number = PerformanceTimer.getNowFunc();\n\n    private static getNowFunc() {\n        if (typeof performance !== \"undefined\" && typeof performance.now !== \"undefined\") {\n            return () => performance.now();\n        }\n\n        // fall back to Date.getTime()\n        return () => {\n            return new Date().getTime();\n        };\n    }\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Deep clone of object.\n *\n * Like `JSON.parse(JSON.stringify(obj))`, but supports basic javascript types (string, number,\n * object), `Date` and `RegExp`s and cycles.\n *\n * Throws error if enounters object with `prototype` assuming that in general class instances\n * cannot be reliably cloned by generic algorithm.\n */\nexport function cloneDeep<T>(obj: T): T {\n    const cache: Map<object, object> = new Map();\n    function cloneInternal(src: any): any {\n        if (src === null) {\n            return null;\n        } else if (typeof src === \"object\") {\n            const cached = cache.get(src);\n            if (cached !== undefined) {\n                return cached;\n            }\n\n            if (Array.isArray(src)) {\n                const result: any[] = [];\n                cache.set(src, result);\n                result.length = src.length;\n                for (let i = 0; i < result.length; ++i) {\n                    result[i] = cloneInternal(src[i]);\n                }\n                return result;\n            } else if (src instanceof Date) {\n                const result = new Date(src.getTime());\n                cache.set(src, result);\n                return result;\n            } else if (src instanceof RegExp) {\n                const result = new RegExp(src.source, src.flags);\n                cache.set(src, result);\n                return result;\n            } else if (src.constructor !== Object) {\n                throw new Error(\"cloneDeep doesn't support objects with custom prototypes\");\n            } else {\n                const result: typeof src = {};\n                cache.set(src, result);\n                for (const key in src) {\n                    if (src.hasOwnProperty(key)) {\n                        result[key] = cloneInternal(src[key]);\n                    }\n                }\n                return result;\n            }\n        } else {\n            // string, number, boolean, undefined and functions are returned as is\n            return src;\n        }\n    }\n\n    const r = cloneInternal(obj);\n    cache.clear();\n    return r;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Get first defined value.\n *\n * Specialized \"replacement\" for `a || b || c` used frequently to get value from various sources\n * (defaults, configs  constants).\n * In contrast to `||`, this function provides proper typing for usual use cases (constant as last\n * argument) and correct treatment of `null` and `undefined`.\n *\n * If last parameter is \"defined\" then return type is `T`, otherwise return type is `T | undefined`.\n *\n * Usage example:\n *\n *     interface Config {\n *         x?: number;\n *     }\n *     const someConfig: Config = {};\n *     const val: number | undefined = undefined;\n *     const DEFAULT = 5;\n *     const x = getOptionValue(val, someConfig.x, DEFAULT);\n *         // typeof x === 'number' because DEFAULT is defined\n *     const y = getOptionValue(val, someConfig.x);\n *         // typeof y === 'number | undefined' because someConfig.x is possibly undefined\n */\n// specialized overloads with last param defined params overload\nexport function getOptionValue<T>(a: T): T;\nexport function getOptionValue<T>(a: T | undefined, b: T): T;\nexport function getOptionValue<T>(a: T | undefined, b: T | undefined, c: T): T;\nexport function getOptionValue<T>(a: T | undefined, b: T | undefined, c: T | undefined, d: T): T;\nexport function getOptionValue<T>(...values: Array<T | undefined>): T | undefined;\n\nexport function getOptionValue<T>(...values: Array<T | undefined>): T | undefined {\n    for (const candidate of values) {\n        if (candidate !== undefined && candidate !== null) {\n            return candidate;\n        }\n    }\n    return undefined;\n}\n\n/**\n * Merge options into existing parameters object.\n *\n * Convenience helper with _similar_ semantics as:\n *\n *     const finalParams1 = { ...defaults, ... options };\n *     const finalParams2 = Object.assign({}, defaults, options);\n *\n * This function doesn't copy _extra_ properties of `options` that doesn't exist in `defaults`.\n * `defaults` is used as _parameters_ template.\n *\n * This doc uses following notion of `option` and `parameter` terms:\n * * `parameter` is a variable, or 'almost constant' of procedure/function/algorith/object\n *    * `parameter` usually have sensible and usually used default\n *    * `parameter` is always defined (no `undefined`, `null` or `?` in type)\n *    * `parameter` can be overriden by specyfying `option` with same name\n * * `option` means value that may be passed optionally, overrides `parameter` value with same name\n *\n * Usage:\n *\n *     interface FooParams {\n *         useTextures: boolean;\n *         opacity: number;\n *     }\n *\n *     const FOO_DEFAULTS: FooParams = {\n *         useTextures: true,\n *         opacity: 0.8\n *     };\n *\n *     type FooOptions = Partial<FooParams>;\n *\n *     function doSomething(options: FooOptions) {\n *         const params = mergeWithOptions(FOO_DEFAULTS, options);\n *             // typeof params === FooParams\n *             // params.opacity = 0.5\n *             // params.useTextures = true\n *             // params.someOtherOptionFromOtherApi is not defined\n *     }\n *     const opt = {opacity: 0.5, someOtherOptionFromOtherApi: 'aaa'};\n *     doSomething(opt);\n *\n * Rationale:\n *   * both `Object.assign` and spread operator copy extra options\n *   * `Object.assign` & `spread operator` may copy `undefined` and `null`s if they really exist\n *     in options object\n *\n * @param parameters parmeters template object holding all expected parameters\n * @param options options object\n * @returns new object with `parameters` overriden by values from `options`\n */\nexport function mergeWithOptions<T extends object>(parameters: T, options?: Partial<T>): T {\n    // NOTE: `as object` needed due to TypeScript bug:\n    //       https://github.com/Microsoft/TypeScript/issues/14409\n    // tslint:disable-next-line:no-object-literal-type-assertion\n    const result = { ...(parameters as object) } as T;\n    if (options === undefined || options === null) {\n        return result;\n    }\n    for (const prop in parameters) {\n        if (parameters.hasOwnProperty(prop)) {\n            const optionValue = options[prop];\n            if (optionValue !== undefined && optionValue !== null) {\n                result[prop] = optionValue as any;\n            }\n        }\n    }\n    return result;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Resolve URI of referenced object w.r.t parent URI.\n *\n * Resolves `childUri` as it would be loaded from location specified by `parentUri`.\n *\n * If `childUri` is absolute, then it is returned unchanged.\n * If `childUri` is origin-absolute path, then only origin path is taken from `parentUri`.\n *\n * See [[baseUri]] for reference how base URL of `parentUri` is determined.\n *\n * Examples:\n *\n *     // normal case, child is sibling\n *     https://foo.com/themes/day.json + images/foo.png -> https://foo.com/themes/images/foo.png\n *\n *     // parent is \"folder\", so child is just located in this folder\n *     https://foo.com/themes/ + images/foo.png -> https://foo.com/themes/images/foo.png\n *\n *     // parent looks like leaf, so last component is stripped\n *     https://foo.com/themes + images/foo.png -> https://foo.com/images/foo.png\n *\n *     // origin-absolute URL, takes only origin from parent\n *     https://foo.com/themes/day.json + /fonts/foo.json -> https://foo.com/fonts/foo.json\n *\n * @param parentUri URI of parent resource\n * @param childUri URI of child as referenced from parent resource\n * @return `childUrl` as if anchored in location of `parentUrl`\n */\nexport function resolveReferenceUri(parentUri: string | undefined, childUri: string): string {\n    if (absoluteUrlWithOriginRe.test(childUri)) {\n        return childUri;\n    } else if (childUri.startsWith(\"/\")) {\n        const origin = getUrlOrigin(parentUri);\n        return origin + childUri;\n    } else {\n        if (childUri.startsWith(\"./\")) {\n            childUri = childUri.substr(2);\n        }\n        const parentBaseUrl = baseUrl(parentUri);\n        return parentBaseUrl + childUri;\n    }\n}\n\nconst absoluteUrlWithOriginRe = new RegExp(\"^(?:[a-z]+:)?//\", \"i\");\n\n/**\n * Returns base URL of given resource URL.\n *\n * `Url` with trailing slash are considered genuine 'locations', they are returned as is, however if\n * `url` ends with name component it is treated as \"leaf\", so last path component is removed.\n *\n * Standalone files (without any folder structure) are considered relative to `./`.\n *\n * Examples:\n * ```\n *     https://foo.com/themes/a.json -> https://foo.com/themes/\n *     https://foo.com/themes/ -> https://foo.com/themes/\n *     https://foo.com/themes -> https://foo.com/ // note, themes is treated as leaf\n *     themes/day.json -> themes/\n *     themes -> ./\n * ```\n */\nexport function baseUrl(url: string | undefined) {\n    if (url === undefined) {\n        return \"./\";\n    }\n    let idx = url.indexOf(\"#\");\n    if (idx !== -1) {\n        url = url.slice(0, idx);\n    }\n    idx = url.indexOf(\"?\");\n    if (idx !== -1) {\n        url = url.slice(0, idx);\n    }\n    idx = url.lastIndexOf(\"/\");\n    if (idx === -1) {\n        return \"./\";\n    } else {\n        return url.substring(0, idx + 1);\n    }\n}\n\n/**\n * Get `origin` part of URL.\n *\n * @example\n *    https://example.com/foo -> https://example.com\n *    //example.com:8080/ -> //example.com:8080\n *    file:///etc/hosts ->\n *\n * @param url input URL\n * @return origin of given URL\n */\nexport function getUrlOrigin(url: string | undefined): string {\n    if (url === undefined) {\n        return \"\";\n    }\n    const parsed = getUrlHostAndProtocol(url);\n    if (parsed.protocol === \"file:\") {\n        return \"file://\";\n    } else if (parsed.host && parsed.protocol) {\n        return parsed.protocol + \"//\" + parsed.host;\n    } else if (parsed.host) {\n        return \"//\" + parsed.host;\n    } else if (parsed.protocol) {\n        return parsed.protocol + \"//\";\n    } else {\n        return \"\";\n    }\n}\n\n/**\n * Parse `host` and `protocol` part from URL.\n */\nexport function getUrlHostAndProtocol(\n    url: string\n): {\n    protocol: string;\n    host: string;\n} {\n    const urlOriginRe = new RegExp(/^(?:([a-z]+:))?\\/\\/([^\\/]*)/, \"i\");\n\n    const match = url.match(urlOriginRe);\n    if (!match) {\n        throw new Error(`getUrlHostAndProtocol: unable to parse URL '${url}'`);\n    }\n    return {\n        protocol: match[1],\n        host: match[2]\n    };\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { resolveReferenceUri } from \"./UrlUtils\";\n\n/**\n * Custom, app-specific URI resolver interface.\n */\nexport interface UriResolver {\n    /**\n     * Attempt to resolve `URI` to `URL`.\n     *\n     * If given resolver doesn't know about this specific kind of `URI`, it should return string as\n     * received.\n     *\n     * @param input `URI`\n     * @returns actual `URL` if this handler knows how locate given `uri` or original `uri`\n     */\n    resolveUri(uri: string): string;\n}\n\nexport interface PrefixUriResolverDefinition {\n    [prefix: string]: string;\n}\n\n/**\n * Basic, import-map like [[UriResolver]].\n *\n * Resolves `uris` basing on exact or prefix match of `key` from `definitions`.\n *\n * In definitions, `key` is matched against input uri with following strategy:\n *  - `key` without trailing `/` -> `key` and input `uri` must be identical\n *  - `key` with trailing `/`, -> `key` is treated as \"package prefix\", so `uri` must start with\n *    `key`\n *\n * Example:\n * ```\n * {\n *     \"local://poiMasterList\": \"/assets/poiMasterList.json\"\n *        // will match only 'local://poiMasterList' and resolve `/assets/poiMasterList.json`\n *     \"local://icons/\": \"/assets/icons/\"\n *        // will match only 'local://icons/ANYPATH' (and similar) and resolve to\n *        // `/assets/icons/ANYPATH\n * }\n * ```\n * Inspired by [`WICG` import maps proposal](https://github.com/WICG/import-maps#the-import-map).\n */\nexport class PrefixMapUriResolver implements UriResolver {\n    constructor(readonly definitions: PrefixUriResolverDefinition) {}\n\n    resolveUri(uri: string) {\n        return Object.keys(this.definitions).reduce((r, key) => {\n            if (key.endsWith(\"/\") && r.startsWith(key)) {\n                const newPrefix = this.definitions[key];\n                return newPrefix + r.substr(key.length);\n            } else if (r === key) {\n                return this.definitions[key];\n            }\n            return r;\n        }, uri);\n    }\n}\n\n/**\n * [UriResolver] that resolve relative `uri`s against to parent resource `uri`.\n */\nexport class RelativeUriResolver implements UriResolver {\n    constructor(readonly parentUri: string) {}\n\n    resolveUri(uri: string) {\n        return resolveReferenceUri(this.parentUri, uri);\n    }\n}\n\n/**\n * Compose URI resolvers.\n *\n * Creates new [[UriResolver]] that applies resolvers in orders or arguments.\n *\n * Example:\n *\n *     const themeUrl = ...; // url of parent object\n *     const childUrlResolver = composeUrlResolvers(\n *           new RelativeUriResolver(themeUrl),\n *           defaultUrlResolver\n *     );\n */\nexport function composeUriResolvers(...resolvers: Array<UriResolver | undefined>): UriResolver {\n    return {\n        resolveUri(originalUrl: string) {\n            return resolvers.reduce((url, resolver) => {\n                if (resolver !== undefined) {\n                    return resolver.resolveUri(url);\n                } else {\n                    return url;\n                }\n            }, originalUrl);\n        }\n    };\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { baseUrl } from \"./UrlUtils\";\n\n/**\n * Get base URL for from where relative URLs will be loaded.\n *\n * * In browser, it resolves to `baseUrl(location.href)` i.e document's base URL\n * (see: https://www.w3.org/TR/WD-html40-970917/htmlweb.html#h-5.1.2).\n *\n * * In node, it resolves to `file://${process.cwd()}`.\n */\nexport function getAppBaseUrl() {\n    if (typeof window === \"undefined\") {\n        if (appBaseUrl !== undefined) {\n            return appBaseUrl;\n        } else {\n            throw new Error(\n                \"getAppBaseUrl: no appBaseUrl defined in worker context, use setAppBaseUrl\"\n            );\n        }\n    }\n    return baseUrl(window.location.href);\n}\n\nlet appBaseUrl: string | undefined;\nexport function setAppBaseUrl(v: string) {\n    appBaseUrl = v;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Chains two functions for further assigning as one wrapped callback function\n */\nexport function chainCallbacks<T extends (this: unknown, ...args: any[]) => any>(\n    f1: T | null | undefined,\n    f2: T\n): T {\n    return function(this: any, ...args: any[]): ReturnType<T> {\n        if (f1) {\n            f1.apply(this, args);\n        }\n        return f2.apply(this, args);\n    } as T;\n}\n","/*\n * Copyright (C) 2017-2019 HERE Europe B.V.\n * Licensed under Apache 2.0, see full license in LICENSE\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport * from \"./lib/GroupedPriorityList\";\nexport * from \"./lib/Logger\";\nexport * from \"./lib/Math2D\";\nexport * from \"./lib/MathUtils\";\nexport * from \"./lib/Mixins\";\nexport * from \"./lib/assert\";\nexport * from \"./lib/CachedResource\";\nexport * from \"./lib/ContextLogger\";\nexport * from \"./lib/PerformanceTimer\";\nexport * from \"./lib/ObjectUtils\";\nexport * from \"./lib/OptionsUtils\";\nexport * from \"./lib/UriResolver\";\nexport * from \"./lib/UrlUtils\";\nexport * from \"./lib/UrlPlatformUtils\";\nexport * from \"./lib/Functions\";\n","declare let self: Worker;\nimport { GeoCoordinates } from \"@here/harp-geoutils\";\nimport { MapView, RenderEvent } from \"@here/harp-mapview\";\nimport { setAppBaseUrl } from \"@here/harp-utils\";\nimport { EventEmitter } from \"events\";\nimport { createMap } from \"./map\";\n\nexport function init() {\n    let map!: MapView;\n    const eventHandler = new EventEmitter();\n\n    self.addEventListener(\"message\", (event: MessageEvent) => {\n        const message = event.data;\n        switch (message.type) {\n            case \"mapview-worker-init\":\n                {\n                    setAppBaseUrl(message.baseUrl);\n                    const canvas: OffscreenCanvas = message.canvas;\n                    (canvas as any).style = {\n                        width: `${message.clientWidth}px`,\n                        height: `${message.clientHeight}px`\n                    };\n                    (canvas as any).clientWidth = message.clientWidth;\n                    (canvas as any).clientHeight = message.clientHeight;\n\n                    map = createMap({\n                        canvas: (canvas as unknown) as HTMLCanvasElement,\n                        pixelRatio: message.pixelRatio\n                    });\n                }\n                break;\n            case \"resize\":\n                {\n                    (map.canvas as any).style = {\n                        width: `${message.width}px`,\n                        height: `${message.height}px`\n                    };\n                    (map.canvas as any).clientHeight = message.height;\n                    (map.canvas as any).clientWidth = message.width;\n                    map.resize(message.width, message.height);\n                }\n                break;\n            case \"lookAt\":\n                {\n                    map.lookAt(\n                        new GeoCoordinates(message.lat, message.long),\n                        message.distance,\n                        message.tiltDeg,\n                        message.headingDeg\n                    );\n                }\n                break;\n            case \"beginAnimation\":\n                {\n                    map.beginAnimation();\n                }\n                break;\n            case \"addEventListener\":\n                {\n                    if (eventHandler.listenerCount(message.name) === 0) {\n                        map.addEventListener(message.name, (ev: RenderEvent) => {\n                            self.postMessage({\n                                type: \"event\",\n                                eventName: ev.type,\n                                data: { type: ev.type, time: ev.time }\n                            });\n                        });\n                    }\n                }\n                break;\n        }\n    });\n}\n"],"sourceRoot":""}